import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt
import os # ูุงุณุชุฎุฏุงู ูุธุงุฆู ูุธุงู ุงูุชุดุบูู ูุซู ุงูุชุญูู ูู ูุฌูุฏ ุงููููุงุช

# --- ุฅุนุฏุงุฏุงุช ุงูุตูุญุฉ ---
st.set_page_config(
    page_title="ูุญูู ุจูุงูุงุช ุงูุณููุงุช",
    page_icon="๐",
    layout="centered" # ูููู ุฃู ุชููู "wide" ุฃูุถุงู
)

st.title("๐ ูุญูู ุจูุงูุงุช ุงูุณููุงุช")
st.markdown("---")

# **ุฃุถู ูุฐุง ุงูุณุทุฑ ููุง ูุนุฑุถ ุงููุณุงุฑ:**
st.info(f"ุงููุณุงุฑ ุงูุญุงูู ููุชุทุจูู: **`{os.getcwd()}`**")

# --- ูุงุฆูุฉ ุงูุณููุงุช ุงููุชุงุญุฉ ---
years = list(range(2020, 2026)) # ูู 2020 ุฅูู 2025

# --- ุงููุงุฌูุฉ ุงูุฌุงูุจูุฉ (Sidebar) ---
st.sidebar.header("ุงุฎุชุฑ ุงูุณูุฉ")
selected_year = st.sidebar.radio(
    "ุงุฎุชุฑ ุณูุฉ ูุนุฑุถ ุจูุงูุงุชูุง:",
    years
)

st.sidebar.markdown("---")
st.sidebar.info("ูุฐุง ุงูุชุทุจูู ูุนุฑุถ ุจูุงูุงุช ูู ูููุงุช CSV ุจูุงุกู ุนูู ุงูุณูุฉ ุงููุฎุชุงุฑุฉ.")

# --- ุงูููุทูุฉ ุงูุฑุฆูุณูุฉ ูุนุฑุถ ุงูุจูุงูุงุช ---
st.subheader(f"ุงูุจูุงูุงุช ููุณูุฉ: {selected_year}")

# ุงุณู ุงูููู ุงููุชููุน
file_name = f"{selected_year}.csv"

# ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงูููู ููุฌูุฏูุง
if os.path.exists(file_name):
    try:
        # ูุฑุงุกุฉ ุงูุจูุงูุงุช ูู ููู CSV
        df = pd.read_csv(file_name)

        # ุงูุชุญูู ูู ุฃู DataFrame ููุณ ูุงุฑุบุงู ูุจู ุงูุฃุนูุฏุฉ ุงููุทููุจุฉ
        if not df.empty and 'Category' in df.columns and 'Value' in df.columns:
            st.write("ุชู ูุฑุงุกุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ:")
            st.dataframe(df) # ูุนุฑุถ ุฌุฏูู ุงูุจูุงูุงุช

            # ุฅูุดุงุก Pie Chart
            st.subheader("ุชูุฒูุน ุงูุจูุงูุงุช (Pie Chart)")
            fig, ax = plt.subplots()
            ax.pie(df['Value'], labels=df['Category'], autopct='%1.1f%%', startangle=90)
            ax.axis('equal') # ูุถูู ุฃู ุชููู ุงูุฏุงุฆุฑุฉ ูุชุณุงููุฉ ุงูุฃุจุนุงุฏ
            st.pyplot(fig) # ูุนุฑุถ ุงูุฑุณู ุงูุจูุงูู ูู Streamlit

        else:
            st.warning(f"ุงูููู '{file_name}' ูุง ูุญุชูู ุนูู ุงูุจูุงูุงุช ุงููุชููุนุฉ ุฃู ุงูุฃุนูุฏุฉ 'Category' ู 'Value'.")

    except Exception as e:
        st.error(f"ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ูุฑุงุกุฉ ุฃู ูุนุงูุฌุฉ ุงูููู '{file_name}': {e}")
else:
    st.warning(f"ููู ุงูุจูุงูุงุช ููุณูุฉ {selected_year} ({file_name}) ุบูุฑ ููุฌูุฏ ูู ููุณ ุงููุฌูุฏ.")
    st.info("ุงูุฑุฌุงุก ุงูุชุฃูุฏ ูู ูุฌูุฏ ููู CSV ููู ุณูุฉ ูู ููุณ ุงููุฌูุฏ.")

st.markdown("---")
st.write("ุชู ุงูุชุทููุฑ ุจูุงุณุทุฉ: [ุงุณูู/ุดุฑูุชู ุฅู ุฃุฑุฏุช]")
